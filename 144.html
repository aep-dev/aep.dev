<!DOCTYPE html>
<html lang="en-US" class="glue-flexbox">
  <head>
    <title>AEP-144: Array fields</title>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link href="//fonts.googleapis.com/css?family=Roboto:100,300,400,500,700|Google+Sans:400,500|Product+Sans:400&amp;lang=en" rel="stylesheet"></link>
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <link rel="stylesheet" type="text/css" media="screen" href="//www.gstatic.com/glue/v22_1/glue.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/assets/css/style.css?v=069c4e02">
    <link rel="stylesheet" type="text/css" media="print" href="/assets/css/print.css?v=069c4e02">
    <script type="text/javascript" src="//code.jquery.com/jquery-3.4.0.min.js"></script>
    <script type="text/javascript" src="//www.gstatic.com/glue/latest/glue-detect.min.js"></script>
    <script type="text/javascript">
      $('html').css('visibility', 'hidden');
      $.when($.ready).then(() => {
        $('html').css('visibility', 'visible');
      });
    </script>
    <script type="text/javascript" src="/assets/js/global.js?v=069c4e02"></script>
    
<script type="text/javascript" src="/assets/js/syntax.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140054909-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-140054909-1');
    </script>
  </head>
  <body>
    <!-- prettier-ignore -->
<header class="glue-header glue-header--single">
  <div class="glue-header__bar glue-header__bar--desktop glue-header__drawer">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                <!--<use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>-->
                </svg>
              </div>
              <p class="glue-header__logo--product">AEPs</p>
            </a>
          </div>
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- LINK BAR-->
      <div class="glue-header__container glue-header__container--flex-auto">
        <nav class="glue-header__link-bar">
          <ul id="list-1" class="glue-header__list">
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/general" aria-level="1">Browse AEPs</a>
                </li>
              
            
              
                <li class="glue-header__item">
                  <a class="glue-header__link" href="/contributing" aria-level="1">Contributing</a>
                </li>
              
            
          </ul>
        </nav>
      </div>
      <!-- CTA-->
      <div class="glue-header__container glue-header__container--cta">
        <div class="glue-header__cta">
        <div class="glue-sitesearch">
          <form method="GET" action="/search">
          <label for="q">Search this site</label>
          <input class="glue-sitesearch__input" type="text" name="q" id="q"
            placeholder="Search AEPs">
          <button type="submit" class="glue-button glue-sitesearch__submit" title="Submit">
            <svg role="img" class="glue-icon glue-icon--24px">
            <use xlink:href="/assets/images/glue-icons.svg#search"></use>
            </svg>
          </button>
          </form>
        </div>
        <a href="https://github.com/aep-dev/aep.dev" target="_blank" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <!-- Mobile header placeholder -->
  <div class="glue-header__bar glue-header__bar--mobile">
    <div class="glue-header__tier">
      <!-- LOCK up-->
      <div class="glue-header__container">
        <div class="glue-header__lock-up">
          <div class="glue-header__hamburger glue-header__hamburger--first-tier">
            <div class="glue-header__hamburger-wrapper">
              <button type="button" class="glue-header__drawer-toggle-btn"
                aria-controls="drawer" aria-expanded="false" aria-label="Open the navigation drawer">
                <svg role="img" class="glue-icon glue-icon--24px"><use xlink:href="/assets/images/glue-icons.svg#menu"></use></svg>
              </button>
            </div>
          </div>
          <div class="glue-header__logo">
            <a class="glue-header__logo-link" href="/" title="Google">
              <div class="glue-header__logo-container">
                <svg role="img" aria-hidden="true" class="glue-header__logo-svg">
                  <!--<use xlink:href="/assets/images/glue-icons.svg#google-color-logo"></use>-->
                </svg>
              </div>
              <p class="glue-header__logo--product">AEPs</p>
            </a>
          </div>
          <!-- SKIP -->
          <a href="#page-content" class="glue-header__skip-content">
            <p class="glue-header__skip-content-text">Jump to Content</p>
          </a>
        </div>
      </div>
      <!-- CTA -->
      <div class="glue-header__container">
        <div class="glue-header__cta">
        <a href="https://github.com/aep-dev/aep.dev" class="glue-button glue-button--high-emphasis">
          <img src="/assets/images/github.png" class="github-logo">
          View on GitHub
        </a>
        </div>
      </div>
    </div>
  </div>
  <div class="glue-header__drawer-backdrop"></div>
</header>
    <div class="glue-page">
      
      <main role="main" id="page-content">
        
<nav id="aep-nav" class="docs-component-nav">
  <ul class="nav-list">
    <li class="nav-item nav-item-header">AEPs by Scope</li>
    <li class="nav-item">
      <a href="/general">General</a>
    </li>
    <li class="nav-item nav-item-header">AEPs</li>
    <li class="nav-item">Meta</li>
      <li class="nav-item">
          <a href="/1">
            <span class="aep-number">1</span>
            AEP Purpose and Guidelines
          </a>
        </li>
      <li class="nav-item">
          <a href="/2">
            <span class="aep-number">2</span>
            AEP Numbering and Organization
          </a>
        </li>
      <li class="nav-item">General</li>
      <li class="nav-item">
          <a href="/3">
            <span class="aep-number">3</span>
            Glossary
          </a>
        </li>
      <li class="nav-item">Resources</li>
      <li class="nav-item">
          <a href="/122">
            <span class="aep-number">122</span>
            Resource paths
          </a>
        </li>
      <li class="nav-item">
          <a href="/126">
            <span class="aep-number">126</span>
            Enumerations
          </a>
        </li>
      <li class="nav-item">
          <a href="/121">
            <span class="aep-number">121</span>
            Resource-oriented design
          </a>
        </li>
      <li class="nav-item">
          <a href="/123">
            <span class="aep-number">123</span>
            Resource types
          </a>
        </li>
      <li class="nav-item">
          <a href="/124">
            <span class="aep-number">124</span>
            Resource association
          </a>
        </li>
      <li class="nav-item">
          <a href="/159">
            <span class="aep-number">159</span>
            Reading across collections
          </a>
        </li>
      <li class="nav-item">Standard Methods</li>
      <li class="nav-item">
          <a href="/131">
            <span class="aep-number">131</span>
            GET for individual resources
          </a>
        </li>
      <li class="nav-item">
          <a href="/151">
            <span class="aep-number">151</span>
            Long-running requests
          </a>
        </li>
      <li class="nav-item">
          <a href="/136">
            <span class="aep-number">136</span>
            Custom operations
          </a>
        </li>
      <li class="nav-item">Fields</li>
      <li class="nav-item">
          <a href="/141">
            <span class="aep-number">141</span>
            Quantities
          </a>
        </li>
      <li class="nav-item">
          <a href="/142">
            <span class="aep-number">142</span>
            Time and duration
          </a>
        </li>
      <li class="nav-item nav-item-active">
          <a href="/144">
            <span class="aep-number">144</span>
            Array fields
          </a>
        </li>
      <li class="nav-item">
          <a href="/145">
            <span class="aep-number">145</span>
            Ranges
          </a>
        </li>
      <li class="nav-item">
          <a href="/140">
            <span class="aep-number">140</span>
            Field names
          </a>
        </li>
      <li class="nav-item">
          <a href="/146">
            <span class="aep-number">146</span>
            Generic fields
          </a>
        </li>
      <li class="nav-item">
          <a href="/148">
            <span class="aep-number">148</span>
            Standard fields
          </a>
        </li>
      <li class="nav-item">
          <a href="/203">
            <span class="aep-number">203</span>
            Field behavior documentation
          </a>
        </li>
      <li class="nav-item">Operations</li>
      <li class="nav-item">
          <a href="/132">
            <span class="aep-number">132</span>
            GET for collections
          </a>
        </li>
      <li class="nav-item">
          <a href="/154">
            <span class="aep-number">154</span>
            Resource freshness validation
          </a>
        </li>
      <li class="nav-item">
          <a href="/158">
            <span class="aep-number">158</span>
            Pagination
          </a>
        </li>
      <li class="nav-item">Design Patterns</li>
      <li class="nav-item">
          <a href="/164">
            <span class="aep-number">164</span>
            Soft delete
          </a>
        </li>
      <li class="nav-item">
          <a href="/210">
            <span class="aep-number">210</span>
            Unicode
          </a>
        </li>
      <li class="nav-item">
          <a href="/211">
            <span class="aep-number">211</span>
            Authorization checks
          </a>
        </li>
      <li class="nav-item">
          <a href="/157">
            <span class="aep-number">157</span>
            Partial responses
          </a>
        </li>
      <li class="nav-item">
          <a href="/160">
            <span class="aep-number">160</span>
            Filtering
          </a>
        </li>
      <li class="nav-item">
          <a href="/161">
            <span class="aep-number">161</span>
            Field masks
          </a>
        </li>
      <li class="nav-item">
          <a href="/162">
            <span class="aep-number">162</span>
            Resource Revisions
          </a>
        </li>
      <li class="nav-item">
          <a href="/214">
            <span class="aep-number">214</span>
            Resource expiration
          </a>
        </li>
      <li class="nav-item">
          <a href="/216">
            <span class="aep-number">216</span>
            States
          </a>
        </li>
      <li class="nav-item">
          <a href="/217">
            <span class="aep-number">217</span>
            Unreachable resources
          </a>
        </li>
      </ul>
</nav>
<section id="jump-content">
          
<aside id="aep-sidebar" class="docs-component-sidebar">
  <table id="aep-summary">
    <tr><th colspan="2">Array fields</th></tr>
    <tr><td>Number</td><td>144</td></tr>
    <tr><td>Permalink</td><td><a href="https://aep.dev/144">aep.dev/144</a></td></tr>
    <tr><td>State</td><td>Approved</td></tr>
    <tr><td>Created</td><td>2020-03-19</td></tr>
    <tr><td>Updated</td><td>2020-03-19</td></tr>
  </table>

  <section id="aep-toc" class="docs-component-sidebar-toc">
    <div class="toc"><span class="toctitle">Contents</span><ul>
<li><a href="#guidance">Guidance</a><ul>
<li><a href="#scalars-and-structs">Scalars and structs</a></li>
<li><a href="#update-strategies">Update strategies</a></li>
</ul>
</li>
</ul>
</div>

  </section>

  <section class="docs-component-sidebar-actions">
    <ul>
      <li><a href="https://github.com/aep-dev/aep.dev/issues/">File Bug</a></li>
      <li><a href="https://github.com/aep-dev/aep.dev/blob/master/aep/general/0144">View source</a></li>
      <li><a href="https://github.com/aep-dev/aep.dev/edit/master/aep/general/0144">Edit this page</a></li>
    </ul>
  </section>
</aside>
<section id="aep-main" class="docs-component-main">
  <section class="section-breadcrumbs">
  <nav
    class="glue-breadcrumbs glue-mod-mt-std glue-mod-mb-std"
    aria-label="You are here."
  >
    <ol class="glue-breadcrumbs__list aep-breadcrumbs">
      <li class="glue-breadcrumbs__item" aria-level="1">
        <a class="glue-breadcrumbs__link" href="/">
          API Enhancement Proposals
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item" aria-level="2">
        <a class="glue-breadcrumbs__link" href="/general">
          General AEPs
        </a>
      </li>
      
      <li class="glue-breadcrumbs__item glue-breadcrumbs__item--active"
          aria-level="3">
        Array fields
      </li>
    </ol>
  </nav>
</section>
  
  <h4 class="aep-number">AEP-144</h4>
  <h1 id="array-fields">Array fields</h1>
<p>Representing lists of data in an API is trickier than it often appears. Users
often need to modify lists in place, and longer data series within a single
resource pose a challenge for pagination.</p>
<h2 id="guidance">Guidance</h2>
<p>Resources <strong>may</strong> use array fields where appropriate.</p>
<div class="highlight language-typescript"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">Book</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// The resource name for the book.</span><span class="w"></span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="c1">// The authors of the book.</span><span class="w"></span>
<span class="w">  </span><span class="nx">authors</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<ul>
<li>Array fields <strong>must</strong> use a plural field name.<ul>
<li>If the English singular and plural words are identical ("moose", "info"),
  the dictionary word <strong>must</strong> be used rather than attempting to coin a new
  plural form.</li>
</ul>
</li>
<li>Array fields <strong>should</strong> have an enforced upper bound that will not cause a
  single resource payload to become too large. A good rule of thumb is 100
  elements.<ul>
<li>If an array data can not be bounded (in other words, if there is a chance
  that the array will be too large to be reasonably returned in a single
  request), the API <strong>should</strong> use a sub-resource instead.</li>
</ul>
</li>
<li>Array fields <strong>must not</strong> represent the body of another resource inline.
  Instead, the field <strong>should</strong> be a array of strings providing the resource
  names of the associated resources.</li>
</ul>
<p><strong>Note:</strong> This document uses the term "array" to refer to a field on a resource
that is a list of elements that have the same type. Some languages and IDLs use
other terms, such as "list", "repeated", or "sequence", and these terms are all
synonymous for the purposes of this document. The term "collection" is
distinct, and refers to a group of resources under a single parent rather than
a field on a resource.</p>
<h3 id="scalars-and-structs">Scalars and structs</h3>
<p>Array fields <strong>should</strong> use a scalar type (such as <code>string</code>) if they are
certain that additional data will not be needed in the future, as using a
struct type adds significant cognitive overhead and leads to more complicated
code.</p>
<p>However, if additional data is likely to be needed in the future, array fields
<strong>should</strong> use a struct instead of a scalar proactively, to avoid parallel
array fields.</p>
<h3 id="update-strategies">Update strategies</h3>
<p>A resource <strong>may</strong> use one of two strategies to enable updating a array field:
direct update using the [standard <code>Update</code>][aip-134] method, or custom <code>Add</code>
and <code>Remove</code> methods.</p>
<p>A standard <code>Update</code> method has one key limitation: the user is only able to
update <em>the entire</em> array. This means that the user is required to read the
resource, make modifications to the array field value as needed, and send it
back. This is fine for many situations, particularly when the array field is
expected to have a small size (fewer than 10 or so) and race conditions are not
an issue, or can be guarded against with [ETags][aip-154].</p>
<p><strong>Note:</strong> Declarative-friendly resources (<a href="/128">AEP-128</a>) <strong>must</strong> use the standard
<code>Update</code> method, and not introduce <code>Add</code> and <code>Remove</code> methods. If declarative
tools need to reason about particular relationships while ignoring others,
consider using a subresource instead.</p>
<p>If atomic modifications are required, and if the array is functionally a set
(meaning that order does not matter, duplicate values are not meaningful, and
non-comparable values such as <code>null</code> or <code>NaN</code> are not used), the API <strong>should</strong>
define custom methods using the verbs <code>Add</code> and <code>Remove</code>:</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Protocol buffers</label><div class="tabbed-content">
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// Add an author to a book.</span>
<span class="k">rpc</span><span class="w"> </span><span class="n">AddAuthor</span><span class="p">(</span><span class="n">AddAuthorRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">Book</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">option</span><span class="w"> </span><span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">post</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;/v1/{book=publishers/*/books/*}:addAuthor&quot;</span>
<span class="w">    </span><span class="n">body</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Remove an author from a book.</span>
<span class="k">rpc</span><span class="w"> </span><span class="n">RemoveAuthor</span><span class="p">(</span><span class="n">RemoveAuthorRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">Book</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">option</span><span class="w"> </span><span class="p">(</span><span class="n">google.api.http</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">post</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;/v1/{book=publishers/*/books/*}:removeAuthor&quot;</span>
<span class="w">    </span><span class="n">body</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>The data being added or removed <strong>should</strong> be a primitive (usually a
  <code>string</code>).<ul>
<li>For more complex data structures with a primary key, the API <strong>should</strong> use
  a map with the <code>Update</code> method instead.</li>
</ul>
</li>
<li>The RPC's name <strong>must</strong> begin with the word <code>Add</code> or <code>Remove</code>. The remainder
  of the RPC name <strong>should</strong> be the singular form of the field being added.</li>
<li>The response <strong>should</strong> be the resource itself, and <strong>should</strong> fully-populate
  the resource structure.</li>
<li>The HTTP method <strong>must</strong> be <code>POST</code>, as usual for [custom methods][aip-136].</li>
<li>The HTTP URI <strong>must</strong> end with <code>:add*</code> or <code>:remove*</code>, where <code>*</code> is the
  camel-case singular name of the field being added or removed.</li>
<li>The request field receiving the resource name <strong>should</strong> map to the URI path.<ul>
<li>The HTTP variable <strong>should</strong> be the name of the resource (such as <code>book</code>)
  rather than <code>name</code> or <code>parent</code>.</li>
<li>That variable <strong>should</strong> be the only variable in the URI path.</li>
</ul>
</li>
<li>The body clause in the <code>google.api.http</code> annotation <strong>should</strong> be <code>"*"</code>.</li>
<li>If the data being added in an <code>Add</code> operation is already present, the method
  <strong>should</strong> accept the request and make no changes (no-op), but <strong>may</strong> error
  with <code>ALREADY_EXISTS</code> if appropriate.</li>
<li>If the data being removed in a <code>Remove</code> operation is not present, the method
  <strong>should</strong> accept the request and make no changes (no-op), but <strong>may</strong> error
  with <code>NOT_FOUND</code> if appropriate.</li>
</ul>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">OpenAPI 3.0</label><div class="tabbed-content">
<div class="highlight language-yaml"><pre><span></span><code><span class="nt">paths</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="s">&#39;/publishers/{publisherId}/books/{bookId}:addAuthor&#39;</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">post</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">addAuthor</span><span class="w"></span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add an author to a book.</span><span class="w"></span>
<span class="w">      </span><span class="nt">requestBody</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">content</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">application/json</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">schema</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">properties</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="nt">author</span><span class="p">:</span><span class="w"></span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">                  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The author to be added.</span><span class="w"></span>
<span class="w">                  </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">responses</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">200</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OK</span><span class="w"></span>
<span class="w">          </span><span class="nt">content</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">application/json</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">schema</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/Book&#39;</span><span class="w"></span>
<span class="w">  </span><span class="s">&#39;/publishers/{publisherId}/books/{bookId}:removeAuthor&#39;</span><span class="p p-Indicator">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">post</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">operationId</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">removeAuthor</span><span class="w"></span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove an author from a book.</span><span class="w"></span>
<span class="w">      </span><span class="nt">requestBody</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">content</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">application/json</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">schema</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">properties</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="nt">author</span><span class="p">:</span><span class="w"></span>
<span class="w">                  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">                  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The author to be removed.</span><span class="w"></span>
<span class="w">                  </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">        </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">      </span><span class="nt">responses</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">200</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">OK</span><span class="w"></span>
<span class="w">          </span><span class="nt">content</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">application/json</span><span class="p">:</span><span class="w"></span>
<span class="w">              </span><span class="nt">schema</span><span class="p">:</span><span class="w"></span>
<span class="w">                </span><span class="nt">$ref</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;#/components/schemas/Book&#39;</span><span class="w"></span>
</code></pre></div>
<ul>
<li>The data being added or removed <strong>should</strong> be a primitive (usually a
  <code>string</code>).<ul>
<li>For more complex data structures with a primary key, the API <strong>should</strong> use
  a map with the <code>Update</code> method instead.</li>
</ul>
</li>
<li>The <code>operationId</code> <strong>must</strong> begin with the word <code>add</code> or <code>remove</code>. The
  remainder of the <code>operationId</code> <strong>should</strong> be the singular form of the field
  being added.</li>
<li>The response <strong>should</strong> be the resource itself, and <strong>should</strong> fully-populate
  the resource structure.</li>
<li>The HTTP method <strong>must</strong> be <code>POST</code>, as usual for [custom methods][aip-136].</li>
<li>The HTTP URI <strong>must</strong> end with <code>:add*</code> or <code>:remove*</code>, where <code>*</code> is the
  camel-case singular name of the field being added or removed.</li>
<li>If the data being added in an <code>Add</code> operation is already present, the method
  <strong>should</strong> accept the request and make no changes (no-op), but <strong>may</strong> error
  with <code>409 Conflict</code> if appropriate.</li>
<li>If the data being removed in a <code>Remove</code> operation is not present, the method
  <strong>should</strong> accept the request and make no changes (no-op), but <strong>may</strong> error
  with <code>404 Not Found</code> if appropriate.</li>
</ul>
</div>
</div>
<p><strong>Note:</strong> If both of these strategies are too restrictive, consider using a
subresource instead.</p>
<h4 id="request-structure">Request Structure</h4>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Protocol buffers</label><div class="tabbed-content">
<div class="highlight language-proto"><pre><span></span><code><span class="c1">// The request structure for the AddAuthor operation.</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">AddAuthorRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// The name of the book to add an author to.</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">(</span><span class="n">google.api.field_behavior</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">REQUIRED</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="n">google.api.resource_reference</span><span class="p">)</span><span class="o">.</span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;library.googleapis.com/Book&quot;</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="c1">// The author to be added.</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">[(</span><span class="n">google.api.field_behavior</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">REQUIRED</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// The request structure for the RemoveAuthor operation.</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">RemoveAuthorRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// The name of the book to remove an author from.</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">book</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">(</span><span class="n">google.api.field_behavior</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">REQUIRED</span><span class="p">,</span>
<span class="w">    </span><span class="p">(</span><span class="n">google.api.resource_reference</span><span class="p">)</span><span class="o">.</span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;library.googleapis.com/Book&quot;</span>
<span class="w">  </span><span class="p">];</span>

<span class="w">  </span><span class="c1">// The author to be removed.</span>
<span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="na">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">[(</span><span class="n">google.api.field_behavior</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">REQUIRED</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>A resource field <strong>must</strong> be included. It <strong>should</strong> be the name of the
  resource (such as <code>book</code>) rather than <code>name</code> or <code>parent</code>.<ul>
<li>The field <strong>should</strong> be [annotated as required][aip-203].</li>
<li>If the field represents the name of another resource, it <strong>should</strong>
  identify the [resource type][aip-123] that it references.</li>
</ul>
</li>
<li>A field for the value being added or removed <strong>must</strong> be included. It
  <strong>should</strong> be the singular name of the field.<ul>
<li>The field <strong>should</strong> be [annotated as required][aip-203].</li>
</ul>
</li>
<li>The request message <strong>must not</strong> contain any other required fields, and
  <strong>should not</strong> contain other optional fields except those described in this
  or another AEP.</li>
</ul>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">OpenAPI 3.0</label><div class="tabbed-content">
<div class="highlight language-yaml"><pre><span></span><code><span class="nt">requestBody</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">content</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">application/json</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">schema</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">properties</span><span class="p">:</span><span class="w"></span>
<span class="w">          </span><span class="nt">author</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w"></span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">The author to be added.</span><span class="w"></span>
<span class="w">            </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
<span class="w">  </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
</code></pre></div>
<ul>
<li>A field for the value being added or removed <strong>must</strong> be included. It
  <strong>should</strong> be the singular name of the field.<ul>
<li>The field <strong>should</strong> be designated as required.</li>
</ul>
</li>
</ul>
</div>
</div>
  <footer>
  Except as otherwise noted, the content of this page is licensed under the
  <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons
  Attribution 4.0 License</a>, and code samples are licensed under the
  <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.
  <span class="no-print">For details, see <a href="/licensing">content
  licensing</a>.</span>
</footer>
</section>

        </section>
      </main>
      
    </div>
    <script src="//www.gstatic.com/external_hosted/hammerjs/v2_0_2/hammer.min.js"></script>
    <script src="//www.gstatic.com/glue/v22_1/glue-vanilla.min.js"></script>
    <script type="text/javascript">
      const headerElement = document.querySelector('.glue-header');
      if (headerElement) {
        new window.glue.ui.header.Header(headerElement);
      }
    </script>
  </body>
</html>